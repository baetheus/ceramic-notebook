import * as S from "fun/schemable";
import * as D from "fun/decoder";
import * as E from "fun/either";
import { pipe } from "fun/fn";

const User = S.schema((s) => s.struct({ ID: s.number(), Name: s.string() }));

const Ingredient = S.schema((s) =>
  s.struct({ ID: s.number(), Name: s.string(), Percentage: s.number() })
);

const Analysis = S.schema((s) =>
  s.partial({
    "SiO2": s.number(),
    "Al2O3": s.number(),
    "Na2O": s.number(),
    "K2O": s.number(),
    "MgO": s.number(),
    "CaO": s.number(),
    "P2O5": s.number(),
    "TiO2": s.number(),
    "Fe2O3": s.number(),
    "ZnO": s.number(),
    "LOI": s.number(),
    "ZrO2": s.number(),
    "CuO": s.number(),
    "B2O3": s.number(),
    "Li2O": s.number(),
    "BaO": s.number(),
    "CoO": s.number(),
    "SrO": s.number(),
    "MnO": s.number(),
    "SnO2": s.number(),
    "FeO": s.number(),
    "Cr2O3": s.number(),
    "MnO2": s.number(),
    "F": s.number(),
    "NiO": s.number(),
    "Pr2O3": s.number(),
    "V2O5": s.number(),
    "PbO": s.number(),
    "Bi2O3": s.number(),
    "Cu2O": s.number(),
    "MoO3": s.number(),
    "CdO": s.number(),
    "ZrO": s.number(),
    "U3O8": s.number(),
    "Nd2O3": s.number(),
    "Er2O3": s.number(),
    "Ho2O3": s.number(),
    "CeO2": s.number(),
    "Ag2O": s.number(),
    "Sb2O3": s.number(),
    "WO3": s.number(),
    "La2O3": s.number(),
  })
);

export const Material = S.schema((s) =>
  pipe(
    s.struct({
      ID: s.number(),
      Name: s.string(),
      "Date Created": s.string(),
      Type: s.string(),
    }),
    s.intersect(s.partial({
      CreatedBy: User(s),
      Cone: pipe(s.string(), s.union(s.number())),
      Surface: s.string(),
      Transparency: s.string(),
      Description: s.string(),
      Ingredients: s.array(Ingredient(s)),
      Subtype: s.string(),
      "Percent Analysis": Analysis(s),
      Atmospheres: s.array(s.string()),
      "Other Names": s.string(),
      Country: s.string(),
      "Parent ID": s.number(),
    })),
  )
);
//   Set(["ID", "Name", "Created By", "Date Created", "Type", "Subtype", "Cone", "Surface", "Transparency", "Description", "Ingredients", "Percent Analysis", "Atmospheres", "Other Names", "Country", "Parent ID"])

const Materials = S.schema((s) => s.array(Material(s)));

export type Materials = S.TypeOf<typeof Materials>;

const DecoderMaterials = D.json(Materials(D.SchemableDecoder));

export const parseFromFile = async (
  file_path: string = "./glazy.json",
): Promise<Materials> => {
  const file_raw = await Deno.readFile(file_path);
  const decoder = new TextDecoder();
  const file = decoder.decode(file_raw);
  const parsed = DecoderMaterials(file);
  if (E.isLeft(parsed)) {
    console.error(D.draw(parsed.left));
    throw new Error(`Unable to parse ${file_path}`);
  }
  return parsed.right;
};

export const TYPES = [
  "Recipe",
  "Analysis",
  "Material",
];

export const COUNTRIES = [
  "Denmark",
  "Belgium",
  "Brazil",
  "United Kingdom",
  "United States",
  "Argentina",
  "South Africa",
  "Canada",
  "Turkey",
  "France",
  "Finland",
  "China",
  "Taiwan",
  "Netherlands",
  "Sweden",
  "Mexico",
  "New Zealand",
  "Poland",
  "Switzerland",
  "Germany",
  "Australia",
  "Russia",
  "Japan",
  "Italy",
  "India",
  "Ukraine",
  "Ireland",
  "Spain",
  "Israel",
  "Singapore",
  "Chile",
  "Croatia",
  "Thailand",
  "Austria",
  "Indonesia",
  "Lithuania",
  "South Korea",
  "Greece",
  "Vietnam",
  "Malta",
  "Bolivia",
  "Czechia",
  "Estonia",
  "Ã…land",
  "Colombia",
  "Hong Kong",
  "Peru",
];

export const ATMOSPHERES = [
  "Oxidation",
  "Reduction",
  "Wood",
  "Salt & Soda",
  "Neutral",
  "Raku",
  "Luster",
];

export const SUBTYPES = [
  "Glaze",
  "Clay Body - Porcelain",
  "Glaze - Iron - Celadon",
  "Glaze - Clear",
  "Glaze - Blue",
  "Glaze - Iron - Slip-Based",
  "Glaze - White, Off-White",
  "Glaze - Iron - Amber",
  "Glaze - Iron",
  "Glaze - Blue - Cobalt",
  "Glaze - Iron - Celadon - Blue",
  "Glaze - Ash",
  "Glaze - Ash - Slip-Based",
  "Glaze - Matte",
  "Glaze - Matte - Magnesium Matte",
  "Glaze - Turquoise",
  "Glaze - Black",
  "Glaze - Iron - Tenmoku",
  "Glaze - Iron - Celadon - Chun",
  "Glaze - Green",
  "Glaze - Salt & Soda",
  "Glaze - Green - Copper",
  "Glaze - Specialty - Metallic",
  "Glaze - Iron - Celadon - Green",
  "Glaze - Iron - Celadon - Yellow",
  "Glaze - Green - Chrome",
  "Clay Body - Stoneware",
  "Clay Body - Stoneware - Slipcasting",
  "Clay Body - Porcelain - Slipcasting",
  "Glaze - Red - Copper",
  "Glaze - Specialty - Crackle",
  "Glaze - Specialty - Crawling",
  "Glaze - Red - Stain",
  "Glaze - Crystalline",
  "Glaze - Green - Oribe",
  "Slip & Engobe - Slip",
  "Glaze - Iron - Tessha, Hare's Fur",
  "Glaze - Iron - Kaki, Tomato Red",
  "Glaze - Blue - Rutile",
  "Glaze - Yellow",
  "Glaze - Iron - Oil Spot",
  "Glaze - Purple",
  "Glaze - Red",
  "Underglaze",
  "Glaze - Shino",
  "Glaze - Shino - Carbon Trap",
  "Glaze - Specialty",
  "Slip & Engobe - Engobe",
  "Glaze - Ash - Synthetic/Fake",
  "Glaze - Black - Slip-Based",
  "Glaze - Refractory",
  "Overglaze",
  "Glaze - Yellow - Iron",
  "Glaze - Crystalline - Aventurine",
  "Clay Body - Stoneware - Sculpture",
  "Clay Body - Stoneware - Throwing",
  "Clay Body - Porcelain - Sculpture",
  "Clay Body",
  "Clay Body - Porcelain - Throwing",
  "Glaze - Specialty - Crater",
  "Glaze - Blue - Nickel",
  "Glaze - Black - Glossy",
  "Glaze - Majolica",
  "Glaze - Red - Pink",
  "Glaze - Wood",
  "Glaze - Single-Fire",
  "Clay Body - Earthenware",
  "Clay Body - Earthenware - Slipcasting",
  "Glaze - Raku",
  "Glaze - Bristol",
  "Glaze - Grey/Gray/Charcoal",
  "Glaze - Red - Copper - Oxblood",
  "Glaze - Shino - White",
  "Glaze - Black - Satin",
  "Glaze - Red - Copper - Flambe",
  "Glaze - Shino - High-Alumina",
  "Glaze - Shino - Traditional",
  "Glaze - Yellow - Stain",
  "Glaze - Purple - Magnesium Matte",
  "Glaze - Iron - Tea Dust",
  "Glaze - Green - Stain",
  "Glaze - Blue - Stain",
  "Glaze - Yellow - Barium",
  "Glaze - Blue - Barium",
  "Glaze - Yellow - Nickel",
  "Glaze - Ash - Nuka",
  "Glaze - Red - Copper - Peach Bloom",
  "Glaze - Purple - Nickel",
  "Slip & Engobe",
  "Glaze - Specialty - Gloop",
  "Glaze - Blue - Strontium",
  "Glaze - Yellow - Manganese",
  "Glaze - Green - Titanium",
  "Glaze - Green - Nickel",
  "Glaze - Crystalline - Micro",
  "Glaze - Purple - Manganese",
  "Clay Body - Stoneware - Hand-building",
  "Clay Body - Stoneware - Raku",
  "Glaze - Crystalline - Manganese",
  "Slip & Engobe - Terra Sigillata",
  "Glaze - Crystalline - Macro",
  "Clay",
  "Ash",
  "Frit",
  "Alumina",
  "Flux",
  "Colorant",
  "Feldspar",
  "Opacifier",
  "Miscellaneous",
  "Silica",
  "Primitive",
  "Clay Body - Earthenware - Sculpture",
  "Clay Body - Stoneware - Salt",
];

export const TRANSPARENCIES = [
  "Transparent",
  "Semi-opaque",
  "Translucent",
  "Opaque",
];

export const CONES = [
  8,
  "9 - 11",
  "8 - 9",
  "9 - 10",
  10,
  9,
  "8 - 10",
  "10 - 11",
  "6 - 10",
  "7 - 10",
  "5 - 10",
  "010 - 09",
  "9 - 12",
  7,
  11,
  "10 - 12",
  "8 - 12",
  "6 - 14",
  "7 - 8",
  6,
  "7 - 9",
  "5 - 9",
  "5 - 6",
  2,
  5,
  "6 - 8",
  "6 - 9",
  4,
  "4 - 8",
  "1 - 3",
  "3 - 6",
  "3 - 5",
  "6 - 7",
  "4 - 9",
  "5 - 8",
  "5 - 7",
  "2 - 4",
  "4 - 6",
  "2 - 6",
  "4 - 7",
  "4 - 12",
  "6 - 11",
  "4 - 5",
  "06 - 04",
  3,
  "05 1/2",
  "08 - 05 1/2",
  "04 - 03",
  1,
  "02 - 6",
  "05 1/2 - 03",
  "05 1/2 - 04",
  "06 - 05",
  "05 1/2 - 01",
  "03 - 02",
  "05 - 03",
  15,
  14,
  "05 - 04",
  "04 - 11",
  "010 - 04",
  "010 - 08",
  "02 - 01",
  "04 - 01",
  "08 - 04",
  "04 - 9",
  "05 1/2 - 10",
  "04 - 12",
  "04 - 6",
  "012 - 010",
  "08 - 10",
  "04 - 02",
  "04 - 10",
  "02 - 1",
  "05 1/2 - 05",
  "012 - 06",
  "07 - 06",
  "07 - 04",
  "016 - 010",
  16,
  "6 - 12",
  "8 - 11",
  "08 - 06",
  "06 - 6",
  "5 1/2 - 7",
  "4 - 10",
  "5 1/2 - 6",
  12,
  "014 - 012",
  "018 - 015",
  18,
  "04 - 4",
  "06 - 03",
  "06 - 3",
  "06 - 4",
  "06 - 02",
  "06 - 5",
  "09 - 08",
  "08 - 02",
  "08 - 2",
  "1 - 4",
  "1 - 9",
  "1 - 6",
  "4 - 14",
  "012 - 08",
  "10 - 14",
  "04 - 1",
  "08 - 1",
  "11 - 12",
  "04 - 3",
  "3 - 11",
  "08 - 9",
  "07 - 6",
  "5 1/2 - 9",
  "4 - 5 1/2",
  "5 1/2",
  "5 - 5 1/2",
  "9 - 13",
  "07 - 5",
  "1 - 10",
  "9 - 14",
  "05 - 3",
  "7 - 13",
  "05 - 02",
  "5 1/2 - 8",
  "7 - 11",
  "2 - 3",
  "10 - 13",
  "022 - 14",
  "05 1/2 - 6",
  "3 - 5 1/2",
  "03 - 01",
  "010 - 06",
  "05 - 7",
  "7 - 12",
  "8 - 13",
  "07 - 05",
  "3 - 8",
  "12 - 13",
  "04 - 5",
  "5 1/2 - 10",
  "3 - 9",
  "5 - 11",
  13,
  "06 - 10",
  "04 - 2",
  "08 - 11",
  "05 - 1",
  "06 - 12",
  17,
  "02 - 2",
  "06 - 01",
  "03 - 1",
  "022 - 10",
  "7 - 14",
  "022 - 2",
  "06 - 1",
  "05 1/2 - 11",
  "04 - 7",
  "06 - 8",
  "010 - 11",
  "010 - 02",
  "05 1/2 - 7",
  "08 - 05",
];

export const SURFACES = [
  "Glossy",
  "Satin-matte",
  "Matte",
  "Satin",
  "Semi-glossy",
  "Dry Matte",
  "Semi-matte",
  "Smooth Matte",
  "Stony Matte",
];

export const ANALYSIS = [
  "SiO2",
  "Al2O3",
  "Na2O",
  "K2O",
  "MgO",
  "CaO",
  "P2O5",
  "TiO2",
  "Fe2O3",
  "ZnO",
  "LOI",
  "ZrO2",
  "CuO",
  "B2O3",
  "Li2O",
  "BaO",
  "CoO",
  "SrO",
  "MnO",
  "SnO2",
  "FeO",
  "Cr2O3",
  "MnO2",
  "F",
  "NiO",
  "Pr2O3",
  "V2O5",
  "PbO",
  "Bi2O3",
  "Cu2O",
  "MoO3",
  "CdO",
  "ZrO",
  "U3O8",
  "Nd2O3",
  "Er2O3",
  "Ho2O3",
  "CeO2",
  "Ag2O",
  "Sb2O3",
  "WO3",
  "La2O3",
];
